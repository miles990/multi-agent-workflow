# Reduce Phaseï¼ˆå…±ç”¨æ¨¡çµ„ï¼‰

> åŒ¯ç¸½æ•´åˆéšæ®µï¼šå°‡å¤šè¦–è§’æˆæœæ•´åˆç‚ºçµ±ä¸€è¼¸å‡º

## æ¦‚è¿°

Reduce Phase è² è²¬ï¼š
1. æ”¶é›†æ‰€æœ‰è¦–è§’å ±å‘Š
2. è­˜åˆ¥å…±è­˜èˆ‡çŸ›ç›¾
3. è§£æ±ºçŸ›ç›¾
4. ç”ŸæˆåŒ¯ç¸½å ±å‘Š

**æ­¤ç‚ºå…±ç”¨æ¨¡çµ„**ï¼Œå„ skill æ ¹æ“šéœ€æ±‚é…ç½®æ•´åˆç­–ç•¥ã€‚

## åŸ·è¡Œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ”¶é›†éšæ®µ                                                        â”‚
â”‚  â€¢ ç­‰å¾…æ‰€æœ‰ Map Agent å®Œæˆ                                       â”‚
â”‚  â€¢ è®€å–æ‰€æœ‰è¦–è§’å ±å‘Š                                              â”‚
â”‚  â€¢ å»ºç«‹ç™¼ç¾ç´¢å¼•                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  äº¤å‰é©—è­‰ï¼ˆå¼•ç”¨ synthesis/cross-validation.mdï¼‰                  â”‚
â”‚  â€¢ è­˜åˆ¥å…±è­˜é»ï¼ˆå¤šè¦–è§’åŒæ„ï¼‰                                      â”‚
â”‚  â€¢ è­˜åˆ¥çŸ›ç›¾é»ï¼ˆè¦–è§’è¡çªï¼‰                                        â”‚
â”‚  â€¢ è­˜åˆ¥ç¨ç‰¹æ´å¯Ÿï¼ˆå–®ä¸€è¦–è§’ç™¼ç¾ï¼‰                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  çŸ›ç›¾è§£æ±ºï¼ˆå¼•ç”¨ synthesis/conflict-resolution.mdï¼‰               â”‚
â”‚  â€¢ åˆ†æçŸ›ç›¾åŸå›                                                   â”‚
â”‚  â€¢ å¤šè¼ªæ¯”è¼ƒåˆ†æ                                                  â”‚
â”‚  â€¢ ç”¢å‡ºè§£æ±ºæ–¹æ¡ˆæˆ–æ¨™è¨˜ã€Œéœ€é€²ä¸€æ­¥è™•ç†ã€                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å ±å‘Šç”Ÿæˆ                                                        â”‚
â”‚  â€¢ åŒ¯ç¸½æ‰€æœ‰ç™¼ç¾                                                  â”‚
â”‚  â€¢ çµ„ç¹”æˆçµæ§‹åŒ–å ±å‘Š                                              â”‚
â”‚  â€¢ ç”¢å‡ºè¡Œå‹•å»ºè­°                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ”¶é›†éšæ®µ

### å¾æª”æ¡ˆè®€å–è¦–è§’å ±å‘Š

**é‡è¦**ï¼šè¦–è§’å ±å‘Šæ‡‰å·²ä¿å­˜åœ¨æª”æ¡ˆä¸­ï¼ˆç”± Map Phase è² è²¬ï¼‰ã€‚

```
è®€å–è·¯å¾‘ï¼š
.claude/memory/{type}/{id}/perspectives/*.md

ç¯„ä¾‹ï¼š
Read â†’ .claude/memory/research/user-auth/perspectives/architecture.md
Read â†’ .claude/memory/research/user-auth/perspectives/cognitive.md
Read â†’ .claude/memory/research/user-auth/perspectives/workflow.md
Read â†’ .claude/memory/research/user-auth/perspectives/industry.md
```

å¦‚æœè¦–è§’å ±å‘Šæª”æ¡ˆä¸å­˜åœ¨ï¼Œè¡¨ç¤º Map Phase æœªæ­£ç¢ºä¿å­˜ï¼Œæ‡‰è©²å ±éŒ¯ã€‚

### âš ï¸ å¤§æª”æ¡ˆè™•ç†ç­–ç•¥

**å•é¡Œ**ï¼šå¤šå€‹è¦–è§’å ±å‘Šåˆä½µå¾Œå¯èƒ½è¶…é 25000 tokens é™åˆ¶ã€‚

**æ ¸å¿ƒåŸå‰‡**ï¼š**å®Œæ•´æ€§å„ªå…ˆ** â€” æ¯å€‹è¦–è§’çš„å®Œæ•´å…§å®¹éƒ½å¿…é ˆè¢«è™•ç†ï¼Œä¸å¯éºæ¼ã€‚

---

#### ğŸ“ æª”æ¡ˆä¿å­˜çµæ§‹ï¼ˆé‡è¦ï¼ï¼‰

**å®Œæ•´è¦–è§’å ±å‘Šå¿…é ˆä¿ç•™**ï¼Œæœ€çµ‚ Memory çµæ§‹å¦‚ä¸‹ï¼š

```
.claude/memory/{type}/{id}/
â”œâ”€â”€ meta.yaml                    # å…ƒæ•¸æ“š
â”œâ”€â”€ perspectives/                # â­ å®Œæ•´è¦–è§’å ±å‘Šï¼ˆMap Phase å·²ä¿å­˜ï¼‰
â”‚   â”œâ”€â”€ architecture.md          # å®Œæ•´å ±å‘Š - ä¿ç•™
â”‚   â”œâ”€â”€ cognitive.md             # å®Œæ•´å ±å‘Š - ä¿ç•™
â”‚   â”œâ”€â”€ workflow.md              # å®Œæ•´å ±å‘Š - ä¿ç•™
â”‚   â””â”€â”€ industry.md              # å®Œæ•´å ±å‘Š - ä¿ç•™
â”œâ”€â”€ summaries/                   # çµæ§‹åŒ–æ‘˜è¦ï¼ˆReduce Phase ç”¢å‡ºï¼‰
â”‚   â”œâ”€â”€ architecture.yaml        # æ‘˜è¦ - ä¾›å¿«é€ŸæŸ¥é–±
â”‚   â”œâ”€â”€ cognitive.yaml           # æ‘˜è¦ - ä¾›å¿«é€ŸæŸ¥é–±
â”‚   â”œâ”€â”€ workflow.yaml            # æ‘˜è¦ - ä¾›å¿«é€ŸæŸ¥é–±
â”‚   â””â”€â”€ industry.yaml            # æ‘˜è¦ - ä¾›å¿«é€ŸæŸ¥é–±
â”œâ”€â”€ synthesis.md                 # åŒ¯ç¸½å ±å‘Šï¼ˆä¸»è¼¸å‡ºï¼‰
â””â”€â”€ metrics.yaml                 # éšæ®µæŒ‡æ¨™
```

**æµç¨‹èªªæ˜**ï¼š

```
Map Phase                          Reduce Phase
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Agent A â”€â†’ perspectives/arch.md    â”Œâ”€ è®€å– arch.md â”€â†’ summaries/arch.yaml
Agent B â”€â†’ perspectives/cog.md     â”œâ”€ è®€å– cog.md â”€â†’ summaries/cog.yaml
Agent C â”€â†’ perspectives/wf.md      â”œâ”€ è®€å– wf.md â”€â†’ summaries/wf.yaml
Agent D â”€â†’ perspectives/ind.md     â””â”€ è®€å– ind.md â”€â†’ summaries/ind.yaml
                                              â†“
                                   æ”¶é›† 4 ä»½æ‘˜è¦ â†’ synthesis.md

âš ï¸ perspectives/*.md æ˜¯å®Œæ•´å ±å‘Šï¼Œå¿…é ˆä¿ç•™ï¼
âš ï¸ summaries/*.yaml æ˜¯æ‘˜è¦ï¼Œä¾›å¿«é€ŸæŸ¥é–±å’Œå¾ŒçºŒå¼•ç”¨
```

---

#### ç­–ç•¥é¸æ“‡æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: è©•ä¼°ç¸½é‡                                                 â”‚
â”‚ æª¢æŸ¥æ‰€æœ‰è¦–è§’å ±å‘Šçš„ç¸½è¡Œæ•¸/å¤§å°                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    ç¸½é‡ < 500 è¡Œï¼Ÿ
         â†“
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    æ˜¯        å¦
    â†“         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç­–ç•¥ A â”‚  â”‚ ç­–ç•¥ B: ä¸¦è¡Œå­ Agent å®Œæ•´è™•ç†ï¼ˆæ¨è–¦ï¼‰               â”‚
â”‚ ç›´æ¥è®€ â”‚  â”‚ æ¯å€‹è¦–è§’ç”±ç¨ç«‹ Agent å®Œæ•´è®€å–ä¸¦ç”¢å‡ºçµæ§‹åŒ–æ‘˜è¦       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### ç­–ç•¥ Aï¼šç›´æ¥è®€å–ï¼ˆå°æª”æ¡ˆï¼Œç¸½é‡ < 500 è¡Œï¼‰

```javascript
// æ‰€æœ‰å ±å‘Šä¸€æ¬¡è®€å–
for (perspective of perspectives) {
  const content = Read(perspectivePath);
  reports.push({ id: perspective, content });
}
// ç›´æ¥é€²è¡Œäº¤å‰é©—è­‰å’ŒåŒ¯ç¸½
```

---

#### ç­–ç•¥ Bï¼šä¸¦è¡Œå­ Agent å®Œæ•´è™•ç†ï¼ˆæ¨è–¦ï¼Œç¢ºä¿å®Œæ•´æ€§ï¼‰

**åŸç†**ï¼šæ¯å€‹è¦–è§’å ±å‘Šç”±ç¨ç«‹å­ Agent **å®Œæ•´è®€å–**ï¼Œç”¢å‡ºçµæ§‹åŒ–æ‘˜è¦ï¼Œä¸» Agent æ”¶é›†æ‘˜è¦é€²è¡Œæœ€çµ‚åŒ¯ç¸½ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸¦è¡Œå•Ÿå‹• 4 å€‹å­ Agent                                            â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Agent A  â”‚  â”‚ Agent B  â”‚  â”‚ Agent C  â”‚  â”‚ Agent D  â”‚        â”‚
â”‚  â”‚ æ¶æ§‹è¦–è§’ â”‚  â”‚ èªçŸ¥è¦–è§’ â”‚  â”‚ å·¥ä½œæµ   â”‚  â”‚ æ¥­ç•Œå¯¦è¸ â”‚        â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚        â”‚
â”‚  â”‚ å®Œæ•´è®€å– â”‚  â”‚ å®Œæ•´è®€å– â”‚  â”‚ å®Œæ•´è®€å– â”‚  â”‚ å®Œæ•´è®€å– â”‚        â”‚
â”‚  â”‚ å ±å‘Š     â”‚  â”‚ å ±å‘Š     â”‚  â”‚ å ±å‘Š     â”‚  â”‚ å ±å‘Š     â”‚        â”‚
â”‚  â”‚    â†“     â”‚  â”‚    â†“     â”‚  â”‚    â†“     â”‚  â”‚    â†“     â”‚        â”‚
â”‚  â”‚ ç”¢å‡ºçµæ§‹ â”‚  â”‚ ç”¢å‡ºçµæ§‹ â”‚  â”‚ ç”¢å‡ºçµæ§‹ â”‚  â”‚ ç”¢å‡ºçµæ§‹ â”‚        â”‚
â”‚  â”‚ åŒ–æ‘˜è¦   â”‚  â”‚ åŒ–æ‘˜è¦   â”‚  â”‚ åŒ–æ‘˜è¦   â”‚  â”‚ åŒ–æ‘˜è¦   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                              â†“                                   â”‚
â”‚                    æ”¶é›† 4 ä»½çµæ§‹åŒ–æ‘˜è¦                           â”‚
â”‚                              â†“                                   â”‚
â”‚                    ä¸» Agent é€²è¡ŒåŒ¯ç¸½                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å­ Agent Prompt æ¨¡æ¿**ï¼š

```markdown
## ä»»å‹™ï¼šè¦–è§’å ±å‘Šæ‘˜è¦æå–èˆ‡ä¿å­˜

è«‹å®Œæ•´è®€å–ä»¥ä¸‹è¦–è§’å ±å‘Šï¼Œç”¢å‡º**çµæ§‹åŒ–æ‘˜è¦**ï¼Œä¸¦**ä¿å­˜åˆ°æª”æ¡ˆ**ã€‚

### å ±å‘Šè·¯å¾‘ï¼ˆè¼¸å…¥ï¼‰
{perspective_report_path}
ä¾‹å¦‚ï¼š.claude/memory/research/user-auth/perspectives/architecture.md

### æ‘˜è¦è·¯å¾‘ï¼ˆè¼¸å‡ºï¼‰
{summary_output_path}
ä¾‹å¦‚ï¼š.claude/memory/research/user-auth/summaries/architecture.yaml

### æ­¥é©Ÿ

1. **å®Œæ•´è®€å–**è¦–è§’å ±å‘Š
2. **åˆ†æ**ä¸¦æå–é—œéµè³‡è¨Š
3. **ç”¢å‡º**çµæ§‹åŒ–æ‘˜è¦ï¼ˆYAML æ ¼å¼ï¼‰
4. **ä¿å­˜**æ‘˜è¦åˆ°æŒ‡å®šè·¯å¾‘

### è¼¸å‡ºæ ¼å¼ï¼ˆå¿…é ˆéµå¾ªï¼‰

```yaml
perspective_id: {id}
source_file: {perspective_report_path}
extracted_at: {timestamp}
confidence: high | medium | low

executive_summary: |
  {2-3 å¥è©±ç¸½çµæ­¤è¦–è§’çš„æ ¸å¿ƒè§€é»}

core_findings:
  - finding: {ç™¼ç¾ 1}
    evidence: {é—œéµè­‰æ“š}
    confidence: {â˜…â˜…â˜…â˜… | â˜…â˜…â˜… | â˜…â˜… | â˜…}
  - finding: {ç™¼ç¾ 2}
    evidence: {é—œéµè­‰æ“š}
    confidence: {â˜…â˜…â˜…â˜… | â˜…â˜…â˜… | â˜…â˜… | â˜…}
  - finding: {ç™¼ç¾ 3}
    evidence: {é—œéµè­‰æ“š}
    confidence: {â˜…â˜…â˜…â˜… | â˜…â˜…â˜… | â˜…â˜… | â˜…}

key_recommendations:
  - {å»ºè­° 1}
  - {å»ºè­° 2}

risks:
  - {é¢¨éšª 1}
  - {é¢¨éšª 2}

cross_reference:
  consensus_points:
    - {å¯èƒ½èˆ‡å…¶ä»–è¦–è§’ä¸€è‡´çš„é»}
  potential_conflicts:
    - {å¯èƒ½èˆ‡å…¶ä»–è¦–è§’è¡çªçš„é»}
  unique_insights:
    - {æ­¤è¦–è§’ç¨ç‰¹çš„æ´å¯Ÿï¼Œä¸å¯éºæ¼}
```

### é‡è¦
- å¿…é ˆ**å®Œæ•´é–±è®€**å ±å‘Šå¾Œå†æ‘˜è¦
- ä¸å¯éºæ¼ä»»ä½•**æ ¸å¿ƒç™¼ç¾**æˆ–**ç¨ç‰¹æ´å¯Ÿ**
- unique_insights ç‰¹åˆ¥é‡è¦ï¼Œé€™äº›æ˜¯å…¶ä»–è¦–è§’å¯èƒ½æ²’æœ‰çš„è§€é»
- **å¿…é ˆå°‡æ‘˜è¦å¯«å…¥æª”æ¡ˆ**ï¼Œä¾›å¾ŒçºŒæŸ¥é–±
```

**ä¸» Agent åŒ¯ç¸½æµç¨‹**ï¼š

```javascript
// 0. ç¢ºä¿ summaries ç›®éŒ„å­˜åœ¨
mkdir -p .claude/memory/{type}/{id}/summaries/

// 1. ä¸¦è¡Œå•Ÿå‹•å­ Agentï¼ˆæ¯å€‹è² è²¬ä¸€å€‹è¦–è§’ï¼‰
const extractionTasks = perspectives.map(p => Task({
  description: `æå–ä¸¦ä¿å­˜ ${p.name} è¦–è§’æ‘˜è¦`,
  prompt: generateExtractionPrompt({
    reportPath: `.claude/memory/{type}/{id}/perspectives/${p.id}.md`,
    summaryPath: `.claude/memory/{type}/{id}/summaries/${p.id}.yaml`
  }),
  subagent_type: 'general-purpose',
  model: 'haiku'  // æ‘˜è¦æå–ç”¨å¿«é€Ÿæ¨¡å‹
}));

// 2. ç­‰å¾…æ‰€æœ‰å­ Agent å®Œæˆï¼ˆæ‘˜è¦å·²ä¿å­˜åˆ°æª”æ¡ˆï¼‰
await Promise.all(extractionTasks);

// 3. è®€å–æ‰€æœ‰æ‘˜è¦æª”æ¡ˆï¼ˆæ¯å€‹ç´„ 1000 tokensï¼Œ4 å€‹å…± 4000 tokensï¼‰
const summaries = perspectives.map(p =>
  Read(`.claude/memory/{type}/{id}/summaries/${p.id}.yaml`)
);

// 3. è§£æ YAML æ‘˜è¦
const parsedSummaries = summaries.map(parseYAML);

// 4. é€²è¡Œäº¤å‰é©—è­‰ï¼ˆåŸºæ–¼å®Œæ•´æ‘˜è¦ï¼‰
const crossValidation = analyzeCrossReferences(parsedSummaries);

// 5. ç”¢å‡ºæœ€çµ‚åŒ¯ç¸½å ±å‘Š
generateSynthesisReport(parsedSummaries, crossValidation);
```

---

#### å“è³ªä¿è­‰æ©Ÿåˆ¶

| æª¢æŸ¥é» | é©—è­‰å…§å®¹ | å¤±æ•—è™•ç† |
|-------|---------|---------|
| æ‘˜è¦å®Œæ•´æ€§ | æ¯å€‹æ‘˜è¦éƒ½æœ‰ core_findings å’Œ unique_insights | é‡æ–°åŸ·è¡Œè©²è¦–è§’çš„æå– |
| äº¤å‰å¼•ç”¨ | consensus_points å’Œ potential_conflicts å·²æ¨™è¨˜ | æ‰‹å‹•æª¢æŸ¥è¦–è§’é–“é—œä¿‚ |
| ä¿¡å¿ƒåº¦ä¸€è‡´æ€§ | é«˜ä¿¡å¿ƒåº¦ç™¼ç¾æœ‰è¶³å¤ è­‰æ“š | é™ç´šæˆ–æ¨™è¨˜å¾…ç¢ºèª |

---

#### Token é ç®—åˆ†é…ï¼ˆç­–ç•¥ Bï¼‰

| éšæ®µ | ç”¨é€” | èªªæ˜ |
|-----|------|------|
| å­ Agentï¼ˆÃ—4ï¼‰ | å„è‡ªç¨ç«‹ context | æ¯å€‹ Agent å®Œæ•´è®€å–ä¸€ä»½å ±å‘Š |
| ä¸» Agent | æ”¶é›† 4 ä»½æ‘˜è¦ | ç´„ 4000 tokensï¼ˆ4 Ã— 1000ï¼‰ |
| ä¸» Agent | äº¤å‰é©—è­‰ + åŒ¯ç¸½ | ç´„ 6000 tokens |

**å„ªå‹¢**ï¼šæ¯å€‹è¦–è§’éƒ½è¢«**å®Œæ•´è™•ç†**ï¼Œä¸æœƒå› ç‚º token é™åˆ¶è€Œéºæ¼é‡è¦å…§å®¹ã€‚

---

#### ä½•æ™‚ä½¿ç”¨å“ªå€‹ç­–ç•¥

| æƒ…æ³ | ç­–ç•¥ | åŸå›  |
|-----|------|------|
| 4 å€‹è¦–è§’ï¼Œæ¯å€‹ < 150 è¡Œ | A | ç¸½é‡å°ï¼Œç›´æ¥è®€å– |
| 4 å€‹è¦–è§’ï¼Œæ¯å€‹ > 150 è¡Œ | B | è¶…é™é¢¨éšªï¼Œç”¨å­ Agent |
| æ·±åº¦ç ”ç©¶ï¼ˆ--deepï¼‰ | B | å ±å‘Šé€šå¸¸è¼ƒé•· |
| å¿«é€Ÿç ”ç©¶ï¼ˆ--quickï¼‰ | A | å ±å‘Šè¼ƒçŸ­ |

### å ±å‘Šæ ¼å¼æ¨™æº–åŒ–

æ¯ä»½è¦–è§’å ±å‘Šæ‡‰åŒ…å«ï¼š

```markdown
## æ ¸å¿ƒç™¼ç¾/å»ºè­°
- é …ç›® 1
- é …ç›® 2
- ...

## è©³ç´°åˆ†æ
...

## å»ºè­°
...

## ä¿¡å¿ƒåº¦
é«˜ / ä¸­ / ä½
```

### å»ºç«‹ç™¼ç¾ç´¢å¼•

```javascript
// æ¦‚å¿µç¤ºæ„
const findingsIndex = {
  consensus: [],      // å¤šè¦–è§’åŒæ„çš„ç™¼ç¾
  conflicts: [],      // è¦–è§’é–“çš„çŸ›ç›¾
  unique: [],         // å–®ä¸€è¦–è§’çš„ç¨ç‰¹æ´å¯Ÿ
  uncertain: []       // ä¿¡å¿ƒåº¦ä½çš„ç™¼ç¾
}
```

## æ•´åˆç­–ç•¥é…ç½®

å„ skill å¯é…ç½®ä¸åŒçš„æ•´åˆç­–ç•¥ï¼š

### research skill

```yaml
reduce_config:
  strategy: synthesis
  output:
    primary: synthesis.md
    secondary: overview.md
  consensus_threshold: 0.75    # 3/4 è¦–è§’åŒæ„
```

### plan skill

```yaml
reduce_config:
  strategy: design_consensus
  output:
    primary: implementation-plan.md
    secondary: milestones.md
  priority: risk_first         # å„ªå…ˆè™•ç†é¢¨éšªç›¸é—œç™¼ç¾
```

### review skill

```yaml
reduce_config:
  strategy: issue_classification
  output:
    primary: review-summary.md
  severity_levels: [BLOCKER, HIGH, MEDIUM, LOW]
  deduplicate: true
```

### verify skill

```yaml
reduce_config:
  strategy: pass_fail
  output:
    primary: release-decision.md
  pass_criteria:
    functional: 1.0            # 100% é€šé
    edge_case: 0.9             # 90% é€šé
    regression: 1.0            # 100% é€šé
```

## å ±å‘Šç”Ÿæˆ

### é€šç”¨åŒ¯ç¸½å ±å‘Šçµæ§‹

```markdown
# {ä¸»é¡Œ} - åŒ¯ç¸½å ±å‘Š

## æ‘˜è¦
ä¸€æ®µè©±ç¸½çµé—œéµç™¼ç¾

## æ–¹æ³•
- è¦–è§’ï¼š{åˆ—è¡¨}
- æ—¥æœŸï¼š{æ—¥æœŸ}
- æ¨¡å¼ï¼š{quick/normal/deep}

## å…±è­˜ç™¼ç¾
### å¼·å…±è­˜
- ç™¼ç¾ 1ï¼š...ï¼ˆ4/4 è¦–è§’åŒæ„ï¼‰

### å¼±å…±è­˜
- ç™¼ç¾ 2ï¼š...ï¼ˆ2/4 è¦–è§’åŒæ„ï¼‰

## çŸ›ç›¾åˆ†æ
### å·²è§£æ±º
- çŸ›ç›¾ 1ï¼š{æè¿°} â†’ {è§£æ±ºæ–¹æ¡ˆ}

### éœ€é€²ä¸€æ­¥è™•ç†
- çŸ›ç›¾ 2ï¼š{æè¿°} â†’ {å»ºè­°æ–¹å‘}

## é—œéµæ´å¯Ÿ
æ•´åˆæ‰€æœ‰è¦–è§’å¾Œçš„æ·±å±¤ç™¼ç¾

## è¡Œå‹•å»ºè­°
1. ç«‹å³è¡Œå‹•ï¼š...
2. çŸ­æœŸè¦åŠƒï¼š...
3. é•·æœŸè€ƒé‡ï¼š...

## é™„éŒ„
å„è¦–è§’å®Œæ•´å ±å‘Šé€£çµ
```

## å“è³ªæª¢æŸ¥

### å ±å‘Šå“è³ªæ¨™æº–

- [ ] æ‘˜è¦æº–ç¢ºåæ˜ æ ¸å¿ƒç™¼ç¾
- [ ] å…±è­˜æœ‰æ˜ç¢ºçš„è¦–è§’æ”¯æŒ
- [ ] çŸ›ç›¾æœ‰æ¸…æ¥šçš„åˆ†æ
- [ ] è¡Œå‹•å»ºè­°å…·é«”å¯åŸ·è¡Œ

### å®Œæ•´æ€§æª¢æŸ¥

- [ ] æ‰€æœ‰è¦–è§’å ±å‘Šéƒ½å·²ç´å…¥
- [ ] æ²’æœ‰éºæ¼é‡è¦ç™¼ç¾
- [ ] çŸ›ç›¾éƒ½æœ‰è™•ç†ï¼ˆè§£æ±ºæˆ–æ¨™è¨˜ï¼‰

## é…ç½®åƒæ•¸

```yaml
reduce_config:
  strategy: synthesis | design_consensus | issue_classification | pass_fail
  cross_validation:
    enabled: true
    consensus_threshold: 0.75
  conflict_resolution:
    enabled: true
    max_rounds: 3
  output:
    primary: string             # ä¸»è¼¸å‡ºæª”æ¡ˆ
    secondary: string           # æ¬¡è¦è¼¸å‡ºæª”æ¡ˆï¼ˆå¯é¸ï¼‰
  quality_check:
    enabled: true
```

## ç›¸é—œæ¨¡çµ„

- [cross-validation.md](../synthesis/cross-validation.md) - äº¤å‰é©—è­‰é‚è¼¯
- [conflict-resolution.md](../synthesis/conflict-resolution.md) - çŸ›ç›¾è§£æ±ºé‚è¼¯
