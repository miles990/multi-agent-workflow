# Supervision Mode

> implement skill çš„æ ¸å¿ƒæ©Ÿåˆ¶ï¼šå³æ™‚ç›£ç£å¼å¯¦ä½œ

## ç›£ç£æ¨¡å¼æ¦‚è¿°

### èˆ‡å…¶ä»– Skill çš„å·®ç•°

| ç‰¹æ€§ | å…¶ä»– Skill | implement Skill |
|------|-----------|-----------------|
| è¦–è§’è§’è‰² | ç¨ç«‹ç ”ç©¶è€… | å³æ™‚ç›£ç£è€… |
| åŸ·è¡Œæ–¹å¼ | å„è‡ªå®Œæˆå¾Œæ•´åˆ | è§€å¯ŸåŒä¸€å¯¦ä½œæµç¨‹ |
| å›é¥‹æ™‚æ©Ÿ | çµæŸæ™‚åŒ¯ç¸½ | ç¨‹å¼ç¢¼ç”¢å‡ºæ™‚å³æ™‚ |
| äº’å‹•æ¨¡å¼ | å¹³è¡Œç¨ç«‹ | å”ä½œç›£ç£ |

### æ ¸å¿ƒåŸå‰‡

```
å¯«ç¨‹å¼ç¢¼ â†’ è¦–è§’å¯©æŸ¥ â†’ æ”¶åˆ°å›é¥‹ â†’ ä¿®æ­£ â†’ ç¹¼çºŒ
    â†‘__________________________|
```

## ç›£ç£å¾ªç’°è©³è§£

### Phase 1: ä¸» Agent å¯¦ä½œ

```
ä¸» Agentï¼š
  1. è®€å–ä»»å‹™æè¿°
  2. è¨­è¨ˆç¨‹å¼ç¢¼çµæ§‹
  3. æ’°å¯«ç¨‹å¼ç¢¼
  4. å®Œæˆä¸€å€‹é‚è¼¯å–®å…ƒï¼ˆå‡½æ•¸/é¡åˆ¥/æ¨¡çµ„ï¼‰
  5. é€šçŸ¥è¦–è§’å¯©æŸ¥
```

### Phase 2: è¦–è§’ä¸¦è¡Œå¯©æŸ¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4 è¦–è§’åŒæ™‚å¯©æŸ¥ï¼ˆä¸¦è¡ŒåŸ·è¡Œï¼‰                                  â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚  â”‚ TDD å®ˆè­·è€…   â”‚  â”‚ æ•ˆèƒ½å„ªåŒ–å¸«   â”‚                         â”‚
â”‚  â”‚              â”‚  â”‚              â”‚                         â”‚
â”‚  â”‚ æª¢æŸ¥ï¼š       â”‚  â”‚ æª¢æŸ¥ï¼š       â”‚                         â”‚
â”‚  â”‚ - æœ‰ç„¡æ¸¬è©¦ï¼Ÿ â”‚  â”‚ - æ™‚é–“è¤‡é›œåº¦ â”‚                         â”‚
â”‚  â”‚ - è¦†è“‹ç‡ï¼Ÿ   â”‚  â”‚ - ç©ºé–“è¤‡é›œåº¦ â”‚                         â”‚
â”‚  â”‚ - é‚Šç•Œæ¡ˆä¾‹ï¼Ÿ â”‚  â”‚ - å¿«å–æ©Ÿæœƒï¼Ÿ â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚  â”‚ å®‰å…¨å¯©è¨ˆå“¡   â”‚  â”‚ ç¶­è­·æ€§å°ˆå®¶   â”‚                         â”‚
â”‚  â”‚              â”‚  â”‚              â”‚                         â”‚
â”‚  â”‚ æª¢æŸ¥ï¼š       â”‚  â”‚ æª¢æŸ¥ï¼š       â”‚                         â”‚
â”‚  â”‚ - è¼¸å…¥é©—è­‰ï¼Ÿ â”‚  â”‚ - å‘½åæ¸…æ™°ï¼Ÿ â”‚                         â”‚
â”‚  â”‚ - SQL æ³¨å…¥ï¼Ÿ â”‚  â”‚ - å‡½æ•¸é•·åº¦ï¼Ÿ â”‚                         â”‚
â”‚  â”‚ - XSS é¢¨éšªï¼Ÿ â”‚  â”‚ - ç¨‹å¼ç¢¼é‡è¤‡ï¼Ÿâ”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 3: å›é¥‹æ”¶é›†

```yaml
feedback_collection:
  timeout: 30s          # æ¯å€‹è¦–è§’æœ€å¤š 30 ç§’
  parallel: true        # ä¸¦è¡ŒåŸ·è¡Œ
  aggregation:
    - collect_all       # æ”¶é›†æ‰€æœ‰å›é¥‹
    - deduplicate       # å»é‡
    - prioritize        # æŒ‰åš´é‡åº¦æ’åº
```

### Phase 4: ä¿®æ­£æ±ºç­–

```
if æœ‰é˜»æ“‹é …ï¼ˆâŒï¼‰:
    å¿…é ˆä¿®æ­£ â†’ å›åˆ° Phase 1
elif æœ‰è­¦å‘Šé …ï¼ˆâš ï¸ï¼‰:
    è¨˜éŒ„ â†’ å¯ç¹¼çºŒï¼ˆå»ºè­°ä¿®æ­£ï¼‰
elif å…¨éƒ¨é€šéï¼ˆâœ…ï¼‰:
    ç¹¼çºŒä¸‹ä¸€å€‹ä»»å‹™
```

## è¦–è§’é…ç½®

### å¯©æŸ¥æ·±åº¦

```yaml
review_depth:
  quick:                # --quick æ¨¡å¼
    perspectives: 2     # TDD + Security
    checks_per_unit: 3  # æ¯å–®å…ƒ 3 é …æª¢æŸ¥

  normal:               # é è¨­æ¨¡å¼
    perspectives: 4     # å…¨éƒ¨è¦–è§’
    checks_per_unit: 5  # æ¯å–®å…ƒ 5 é …æª¢æŸ¥

  deep:                 # --deep æ¨¡å¼
    perspectives: 6     # é¡å¤– a11y + i18n
    checks_per_unit: 10 # æ¯å–®å…ƒ 10 é …æª¢æŸ¥
```

### è¦–è§’æ¬Šé‡

```yaml
perspective_weights:
  security-auditor: 1.5    # å®‰å…¨å•é¡Œæ¬Šé‡æœ€é«˜
  tdd-enforcer: 1.2        # æ¸¬è©¦æ¬¡ä¹‹
  performance-optimizer: 1.0
  maintainer: 0.8          # ç¶­è­·æ€§æ¬Šé‡è¼ƒä½
```

## é˜»æ“‹è¦å‰‡

### ç„¡æ¢ä»¶é˜»æ“‹

ä»¥ä¸‹æƒ…æ³å¿…é ˆä¿®æ­£æ‰èƒ½ç¹¼çºŒï¼š

```yaml
unconditional_blocks:
  security:
    - sql_injection_possible
    - xss_vulnerability
    - hardcoded_secret
    - insecure_auth

  tdd:
    - new_public_function_without_test
    - critical_path_untested

  performance:
    - memory_leak_detected
    - infinite_loop_risk
```

### æ¢ä»¶é˜»æ“‹

é”åˆ°é–¾å€¼æ™‚é˜»æ“‹ï¼š

```yaml
conditional_blocks:
  tdd:
    coverage_below: 80%

  performance:
    complexity_above: "O(nÂ³)"

  maintainer:
    function_lines_above: 200
    cyclomatic_complexity_above: 20
    duplicate_code_ratio_above: 0.3
```

## åŒæ­¥æª¢æŸ¥é»

### S1: 50% ä»»å‹™å®Œæˆ

```yaml
sync_point_1:
  trigger: tasks_completed >= 50%
  actions:
    - pause_implementation
    - collect_perspective_reports
    - generate_interim_summary
    - user_confirmation: optional
  continue_if:
    - no_critical_issues
    - pass_rate >= 70%
```

### S2: 80% ä»»å‹™å®Œæˆ

```yaml
sync_point_2:
  trigger: tasks_completed >= 80%
  actions:
    - pause_implementation
    - run_integration_tests
    - check_cross_module_issues
    - user_confirmation: recommended
  continue_if:
    - integration_tests_pass
    - no_regression
```

## å›é¥‹æ ¼å¼æ¨™æº–

### è¦–è§’å›é¥‹çµæ§‹

```
[è¦–è§’åç¨±] å¯©æŸ¥ï¼š

å°æ–¼ {code_location}ï¼š

ç‹€æ…‹ï¼šâœ… / âš ï¸ / âŒ

ç™¼ç¾ï¼š
  {ç¬¦è™Ÿ} {ç™¼ç¾æè¿°}
  {ç¬¦è™Ÿ} {ç™¼ç¾æè¿°}

å»ºè­°ï¼š
  ğŸ’¡ {å»ºè­°å…§å®¹}
  ğŸ’¡ {å»ºè­°å…§å®¹}

{å¦‚æœ‰é˜»æ“‹ï¼šé˜»æ“‹åŸå› å’Œå¿…é ˆä¿®æ­£é …}
```

### æ•´åˆå›é¥‹çµæ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¶œåˆå›é¥‹ï¼ˆ4 è¦–è§’æ•´åˆï¼‰                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é˜»æ“‹é …ï¼ˆå¿…é ˆä¿®æ­£ï¼‰ï¼š                     â”‚
â”‚   âŒ [{è¦–è§’}] {å•é¡Œæè¿°}                 â”‚
â”‚                                          â”‚
â”‚ è­¦å‘Šé …ï¼ˆå»ºè­°ä¿®æ­£ï¼‰ï¼š                     â”‚
â”‚   âš ï¸ [{è¦–è§’}] {å•é¡Œæè¿°}                â”‚
â”‚                                          â”‚
â”‚ é€šéé …ï¼š                                 â”‚
â”‚   âœ… [{è¦–è§’}] {ç¢ºèªå…§å®¹}                 â”‚
â”‚                                          â”‚
â”‚ å»ºè­°é …ï¼ˆå¯é¸æ”¹é€²ï¼‰ï¼š                     â”‚
â”‚   ğŸ’¡ [{è¦–è§’}] {å»ºè­°å…§å®¹}                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ•ˆèƒ½è€ƒé‡

### å¯©æŸ¥æ™‚é–“æ§åˆ¶

```yaml
timing:
  per_perspective_max: 30s    # å–®è¦–è§’æœ€é•·
  total_review_max: 60s       # ç¸½å¯©æŸ¥æœ€é•·
  feedback_batch_size: 5      # æ‰¹æ¬¡è™•ç†å¤§å°
```

### å¿«å–ç­–ç•¥

```yaml
caching:
  reuse_unchanged: true       # æœªè®Šæ›´ç¨‹å¼ç¢¼è¤‡ç”¨çµæœ
  cache_duration: 10m         # å¿«å–æœ‰æ•ˆæœŸ
  invalidate_on:
    - file_modified
    - dependency_changed
```

## ç›¸é—œè³‡æº

- [å›é¥‹å¾ªç’°é…ç½®](./feedback-loop.md)
- [pass@k é‡è©¦æ©Ÿåˆ¶](./pass-at-k-retry.md)
- [é è¨­è¦–è§’é…ç½®](../01-perspectives/_base/default-perspectives.md)
