# 風險分析師視角報告

> 視角：風險分析師
> 聚焦：潛在風險、依賴問題、失敗場景

## 風險識別

### R1: PLAN 輸出格式不一致

**嚴重度**：高
**可能性**：中

**描述**：PLAN 階段產出的 implementation-plan.md 格式可能不一致，導致 TASKS 解析失敗。

**緩解策略**：
1. 定義明確的 PLAN 輸出 schema（文件化）
2. 在 TASKS 載入時進行格式驗證
3. 提供容錯解析，缺失欄位使用預設值
4. 失敗時提供清晰的錯誤訊息指引

**監控指標**：PLAN 載入失敗率

---

### R2: 任務粒度不一致

**嚴重度**：中
**可能性**：高

**描述**：不同視角產出的任務粒度差異大，部分太粗（2小時）部分太細（5分鐘）。

**緩解策略**：
1. 在視角 prompt 中明確定義粒度範圍（10-60 分鐘）
2. REDUCE 階段進行粒度檢查
3. 超出範圍的任務標記警告
4. 提供任務拆分/合併建議

**監控指標**：任務預估時間分布

---

### R3: 循環依賴

**嚴重度**：高
**可能性**：低

**描述**：任務依賴形成循環，導致無法排序。

**緩解策略**：
1. dependency-analyst 使用 DAG 驗證
2. 發現循環時立即報錯
3. 提供循環路徑視覺化
4. 建議手動解決方案

**監控指標**：循環依賴檢測次數

---

### R4: IMPLEMENT 無法消費 tasks.yaml

**嚴重度**：高
**可能性**：中

**描述**：tasks.yaml 格式與 IMPLEMENT 期望不符，導致整合失敗。

**緩解策略**：
1. 同步更新 IMPLEMENT 以消費 tasks.yaml
2. 提供向後相容的轉換層
3. 漸進式整合（先部分使用，再完全依賴）
4. 維護版本號確保相容性

**監控指標**：IMPLEMENT 載入成功率

---

### R5: 視角衝突無法解決

**嚴重度**：中
**可能性**：低

**描述**：多個視角對同一功能產出衝突的任務定義。

**緩解策略**：
1. 使用任務類型前綴區分（T-F-, TEST-, RISK-）
2. 衝突時保留全部，由 REDUCE 標記
3. 需要人工決策時暫停並詢問

**監控指標**：衝突標記數量

## 風險矩陣

```
            可能性
        低     中     高
     ┌──────┬──────┬──────┐
  高 │  R3  │ R1,R4│      │
嚴   ├──────┼──────┼──────┤
重   │  R5  │  R2  │      │
度   ├──────┼──────┼──────┤
  低 │      │      │      │
     └──────┴──────┴──────┘
```

## 回退點設計

| 回退點 | 觸發條件 | 動作 |
|--------|----------|------|
| BP-1 | PLAN 載入失敗 | 停止，要求修正 PLAN |
| BP-2 | 依賴分析失敗（循環） | 停止，顯示循環路徑 |
| BP-3 | 任務分解視角全部失敗 | 回退到 PLAN 階段 |
| BP-4 | REDUCE 整合失敗 | 重試一次後停止 |

## 監控任務建議

以下任務應加入 tasks.yaml：

```yaml
- id: RISK-MONITOR-001
  type: monitoring
  name: "設置 TASKS 階段監控"
  description: "監控任務分解品質指標"
  metrics:
    - "任務粒度分布"
    - "依賴複雜度"
    - "視角衝突率"
```

## 整體風險評估

| 維度 | 評分 | 說明 |
|------|------|------|
| 技術風險 | 低 | 使用成熟的 DAG 演算法 |
| 整合風險 | 中 | 需要同步更新 IMPLEMENT |
| 品質風險 | 低 | 有明確的驗證機制 |
| 時程風險 | 低 | 可漸進式實施 |
